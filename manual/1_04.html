<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>Monkey PHP Framework</title>
<link type="text/css" href="statics/css/base.css" rel="stylesheet" />
<script type="text/javascript" src="statics/js/jquery.min.js"></script>
<!--prettify-->
<link type="text/css" href="statics/css/prettify.css" rel="stylesheet" />
<script type="text/javascript" src="statics/js/prettify.js"></script>
<script type="text/javascript" src="statics/js/html5.js"></script>
<script type="text/javascript" src="statics/js/monkey.js"></script>
</head>

<body>
<!--page_wrap:start-->
<div class="page_wrap">

<p>
<h2>1.4  网站配置</h2>
<br />
<h3>配置的存放位置</h3>
system/apps/应用目录/Configs/内。<br /><br />

<h3>配置写法</h3>
system/vendor/monkey/Globe/Configs/内有默认配置供你参考。<br />
一、基础配置<br />
存放文件：base.ini.php
<pre class="prettyprint linenums">
\Monkey\App\Config::set('timezone','PRC');
\Monkey\App\Config::set('action_prefix','action_');
</pre>
读取方法：
<pre class="prettyprint linenums">
$action_prefix= $app->getConfig('action_prefix','');
</pre><br />
二、组件配置<br />
存放文件：组件名.ini.php，如cache.ini.php
<pre>
/**
 * 缓存组件提供者
 */
\Monkey\App\Config::setComponentProvider('cache',
    array(
        'default_provider'=>'file',//默认提供者
        'file'          =>'\Monkey\Cache\File', //每个提供者的具体类
        'apc'           =>'\Monkey\Cache\Apc',
    )
);
/**
 * 文件缓存的专用配置 ， 3个参数， 参数1：组件名， 参数2：提供者名， 参数3：具体配置（一般为数组）
 */
\Monkey\App\Config::setComponentConfig('cache','file',
    array(
        'expire'=>3600,//默认缓存时间
        'dir'           =>'/temp/fileCache',//缓存文件的绝对路径，留空为 temp目录/filecache
        'filename'      =>'data',
        'filesize'      =>'15M',
        'check'         =>false,
    )
);
/**
 * apc缓存的专用配置
 */
\Monkey\App\Config::setComponentConfig('cache','apc',
    array(
        'expire'=>3600,//默认缓存时间
    )
);
</pre>
读取方法：
<pre class="prettyprint linenums">
$config=$app->config->getComponentConfig('cache','apc');
</pre><br />

<h3>路由配置</h3>
一、路由组件配置<br />
存放文件名：route.ini.php
<pre class="prettyprint linenums">
/**
 * 路由组件提供者
 */
\Monkey\App\Config::setComponentProvider('router',
    array(
        'default_provider'=>'default',
        'default'     =>'\Monkey\Router\Router',
    )
);
/**
 * MonkeyPHP提供的默认路由组件的配置
 */
\Monkey\App\Config::setComponentConfig('router','default',
    array(
        //路由存贮配置，相对应用目录。
        'map_file'           => '/data/router.map.php',//路由器到控制器的映射表
        'pattern_option'=>array(
            //路由匹配时的编译标签，简记名（只能用一对花括号括起来）=>正则表达式（只能用一对括号括起来）
            '{i}'       =>"(\d+)",
            '{s}'       =>"([^\/]+)",
            '{year}'    =>"([1-2]\d{3})",
            '{month}'   =>"(1[0,1,2]|[1-9])",
            '{day}'     =>"([1-9]|[1,2][0-9]|3[0,1])",
            '{name}'    =>"(\w+)",
            '{zh|en}'   =>"(zh|en)",
            '{json}'    =>"(\.json)",
        ),
        'router_class_auto_prefix'=>true,  //自动将router表中类名加上前缀 \应用命名空间\Controller\

        //三个选择：rewrite（需服务器支持）、pathinfo（需服务器支持）、get（传统方式）
        'search_mode'               =>'rewrite',
        //get字段上的显式方法设置，如http://www.xxx.php?r=index
        'search_get'                =>'r',
    )
);
</pre>
二、路由映射表配置<br />
存放文件位置：system/apps/DefaultApp/data/router.map.php
<pre>
/******** 路由器到控制器的映射表——简称路由映射表（示例） ********/
//其中请求方法get可以省略，其它如post等则不能省略
return array(
    //静态路由
    'get/'       =>'Index:index',  //'Index:index'相当于请求\DefaultApp\Controller\Index类的action_index方法
    '/'          =>'Index:index', //效果同上 
    
    'get/hello'  =>'Index:hello',  
    '/hello'     =>'Index:hello', //效果同上 

    '/blog'      =>'Blog\Blog:index', //控制器支持子命名空间

    //动态标识路由，使用了路由组件配置中的编译标签
    '/{zh|en}:language'    =>'Index:index',  //{zh|en}的匹配结果将作为参数名language的值
    '/blog/{s}:title'      =>'Blog:get',     //{s}的匹配结果将作为参数名title的值
    'post/article/{year}/{month}/{s}:year:month:title'    =>'Article:modify',     //这里有三个参数
    
    //动态正则路由，路由中直接使用正则表达式，但有个限制：不能嵌套括号！
    '/article/([1-9]\d{3})/(1[0,1,2]|[1-9])/([^\/]+):year:month:title'=>'Article:get',
);
</pre>
</p>
</div>
<!--page_wrap:end-->
</body>
</html>